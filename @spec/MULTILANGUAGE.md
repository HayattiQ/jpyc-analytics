# MULTILANGUAGE.md

## 目的
JPYC Analytics の UI を多言語対応させ、初期段階では日本語を基点として英語翻訳を提供する。プロダクト内の文言管理と翻訳更新の運用フローを明確化する。

## 対応方針（アイデア）

1. **React への i18n 実装**
   - `react-i18next` + `i18next` など実績のあるライブラリを採用。
   - `Suspense` と併用しつつ、Edge/SSR/CSR いずれでも動作する設定を選択。
   - 文言取得は `useTranslation()` フックを基本とし、フォールバックは日本語。

2. **日本語をデフォルト言語に設定**
   - `i18next` の `fallbackLng` および `supportedLngs` を `['ja', 'en']` として構成。
   - URL パラメータ・ローカルストレージなどで言語切り替えを保持（検討中: `/en` サブパス or UI トグル）。

3. **言語リソースの JSON 管理**
   - `web/src/locales/ja/common.json`, `web/src/locales/en/common.json` のように配置。
   - キー命名は `feature.section.label` 形式で一貫性を担保。
   - 将来的な言語追加を見越し、名前空間ごとの分割も検討。

4. **GitHub Actions による翻訳チェック**
   - `git diff` で `ja` リソースの変更を検出し、英語キー不足を CI で失敗させる。
   - 追加で、OpenAI や機械翻訳 API を呼び出して英語案を自動生成し PR にコメントするワークフローを別途検討。
   - Action 実行時は secrets（翻訳 API キー等）を扱わない or マスク処理を徹底。

5. **日本語テキスト検出アラート**
   - GitHub Actions（`pull_request` / `push`）で `web/src` などアプリコードを走査し、正規表現（ひらがな/カタカナ/漢字）にマッチする文字列を検出。
   - `::warning::` ログまたは PR コメントで「未翻訳の日本語が残っている」旨を通知し、翻訳漏れを早期発見。
   - `locales/ja/**` やドキュメント (`@spec/**`) は除外対象として設定し、正規の日本語コンテンツには影響させない。
   - しきい値（例: 30 文字以上）や diff 対象ファイルのみに限定するなど、誤検知対策を実装する。

## 次のステップ（例）
1. ライブラリ選定・導入（`bun i i18next react-i18next` 等）。
2. 既存文言のキー化と `ja` リソースの作成。
3. 英語ファイルを作り、初期翻訳を投入（機械翻訳 + 人手確認）。
4. GitHub Actions（翻訳差分チェック + 自動提案）のドラフト実装。
